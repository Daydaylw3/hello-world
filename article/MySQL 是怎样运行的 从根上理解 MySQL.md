## 1.6 服务器处理客户端请求

以比较复杂的查询请求为例来展示一下大致的过程

大致需要分为3 部分:

+ 连接管理
+ 解析与优化
+ 存储引擎

### 1.6.1 连接管理

> 当该客户端退出时会与服务器断开连接， 服务器并不会立即把与该客户端交互的线程销毁， 而是把它缓存起来， 在另一个新的客户端再进行连接时，把这个缓存的线程分配给该新客户端.这样就不用频繁地创建和销毁线程，从而节省了开销。

我们也需要限制可以同时连接到服务器的客户端数量

服务器程序会对客户端程序提供的主机信息、用户名、密码等信息进行认证

### 1.6.2 解析与优化

查询缓存、语法解析和查询优化

#### 1.6.2.1 查询缓存

> 把刚刚处理过的查询请求和结果缓存起来. 如果下一次有同样的请求过来，直接从缓存中查找结果就好了

+ 查询缓存可以在不同的客户端之间共享
+ 两个查询请求有任何字符上的不同（例如，空格、注释、大小写）都会导致缓存不会命中
+ 如果查询请求中包含某些系统函数、用户自定义变量和函数、系统表，如 `mysql 、information_schema、performance_schema` 数据库中的表，则这个请求就不会被缓存
+ MySQL 的缓存系统会监测涉及的每张表，只要该表的结构或者数据被修改，则与该表有关的所有查询缓存都将变为无效并从查询缓存中删除！

> 从MySQL 5.7.20 开始，不推荐使用查询缓存， 在MySQL8.0 中直接将其删除